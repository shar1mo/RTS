# Менеджер ресурсов

- В ОСРВ (QNX, VxWorks) предоставляет интерфейс файлов: open/read/write/ioctl через диспетчеризацию.
- На Linux аналог можно смоделировать сервером на UNIX-сокетах: `accept` ~ open, `recv` ~ read, `send` ~ write.
- Данные/состояние устройства хранятся в памяти сервера; можно ввести OCB/контекст сеанса в структуре потока.
- Безопасность: права на сокетный файл, валидация входных данных.
- Расширения: команды управления (простые текстовые или бинарные протоколы), неблокирующие режимы, poll/epoll.

## Дизайн протокола

- Простая текстовая схема: команды вида `CMD arg1 arg2...` с ответами `OK ...` или `ERR code`.
- Бинарная схема: фиксированные заголовки (тип, длина, версия) и полезная нагрузка.
- Необходимо учитывать фрагментацию/склейку TCP‑потоков (на UNIX‑сокетах тоже): использовать длину/разделители.

## Контекст соединения (OCB)

- Для каждого клиента можно хранить структуру: текущая позиция, права, буферы, тайм‑ауты.
- Для многопоточности: защищать общие структуры мьютексами; избегать долгих операций под блокировкой.

## Безопасность и тестирование

- Ограничить права на файл сокета (umask/`chmod`). Проверять длины и корректность входных данных.
- Тесты: позитивные (валидные команды) и негативные (ошибочные входы, разрывы).

Практика:

- `resmgr.c` — скелет сервера; студент добавляет протокол, состояние и обработку команд.
- `client.c` — простой клиент для проверки.
